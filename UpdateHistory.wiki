#summary 更新内容のメモ書き
#labels Featured

更新内容のメモ書き用。
<wiki:toc max_depth="1" />

=Current=
  * 再生済み動画フラグ復元で、問題なく動いているがコード的におかしい部分を修正。
  * 動画詳細で、初っ端にリンクを張る対象があると何も表示されないのを修正。
  * sm,nmだけでなくso,ze動画を対象に広げる。

=0.9.14=
  * リクエスト受け付けチェックするための、ユーザカスタムスクリプトを実行できるようにした。<br>リクエスト制限設定では出来ないようなリクエストチェックができるかわり、チェック用Javascriptコード書けってなわけですが。
  * F5の再描画で、ストックだけでなく、リクエストも再描画するように。
  * コメントリフレクション登録は、登録済みの場合、一旦解除しないと設定を変更できなかったが、上書きで設定し直しに変更。<br>加えて、デフォルト値を(設定済みの場合)名前にするようにした。<br>ラジオボタンは初期値のままで。
  * コメントリフレクション時に行われる、運営コマンドにならないようにする元コメントの加工を、全角空白で挟む→`\u200b`(ZWSP)に変更。<br>見かけ上は空白がなくなる。
  * 枠取り待機ページで起動したときに、まだ開始していない放送に接続しようとしてエラーになるので、生放送のページ以外(gate/lv0000 とか editstream/lv0000 とか)から起動したときは、オフライン扱いに。
  * 行頭に`/`があると視聴者コマンドとして動画IDをリクエストとして受け取らなかったけど、`/del`で始まってなければリクエストとして取るようにした。
  * 動画分類機能を、とりあえず問題なく動いてそうだな…という状態で追加。
  * メインウィンドウで使用するフォント設定を追加。

=0.9.13=
  * 動画の時間の秒の部分が 08～09秒のときに、0秒と同じになっていたのを修正。<br>割合として1/30くらいの動画で次曲再生開始のタイマーがおかしかったはず。
  * 運営コメのマクロ展開に正規表現を使わない方法に変更。<br>まぁ先頭から`{}`の入れ子具合をスキャンして最も外側の部分を取ってくるだけなので、処理速度は遅くならないはず。
  * ロスタイム時間推定を行うようにした。(次動画の選択で使用)<br>1分ちょっとですぐ終わるか2分近くまで行くかどっちつかずの場合、1分とします。(動画が切れないよう、原則、短くなる方向に)
  * ステータスバーの放送時間のツールチップで予想ロスタイム時間を表示するように。
  * コメントリフレクションのときにコメントを一部加工していたけど、行頭に全角空白でも突っ込んどけば良いんじゃない?と、そのように変更。

=0.9.12=
  * コメントサーバから切断されたときに、とりあえずalertダイアログを出すように。<br>放送中切断されることがあれば、再接続お願いします。放送終了時は当然のごとくダイアログでます。
  * コメントリフレクション時の名前の表示の仕方を変更。<br>「`名前さん> コメント`」から「`名前さん:<br>コメント`」に。
  * コメントリフレクション時の名前表示タイプを2種類から選択するように。<br>左上にある名前表示専用欄か、コメントに含まれるかの二択。
  * リク、ストック、コメントビューで、テキストの範囲選択＆コピーができるように。<br>コンテキストメニューには用意していないので、CTRL+CとかApple+Cで。<br>CTRL+Aの全選択はドキュメント全体(ウィンドウ全体)を選択するので注意。
  * リク、ストック、コメなど、キーボードでのスクロールが効くように。
  * リク、ストック、再生履歴のバックアップ・復元を搭載。これはコマンドメニューの中に。<br>DBに保存しているのでちょっとディスクアクセスで引っかかる感があるけど、頻繁に操作されるわけではないからいいか。
  * ついでに、リク、ストック、再生履歴の全消去が押されたときに、自動でsystem-backupとして保存します。(アンドゥ1回分だけ)
  * 運営コメント設定のプリセット登録を追加<br>運営コメはコミュ別に差し替えしやすいようにしたかったんだよね。動画情報はやらなくていいかな…ときどき差し替えたいときもあるけど。テキストファイルにメモっておくか、`{=statement}`でがんばってもらいますか。

=0.9.11=
  * 事後確率が第1候補と第2候補の間に0.2以上の差がない場合、分類不能としてundefinedを返すように。
  * /playコマンドが飲み込まれてしまったときに自動進行ができなくなる対策を追加。とはいっても再生するはずの動画の時間経過しないと次の動画に行かないですが。<br>status=okならきちんとコメント配信してください…＞ドワンゴ<br>サーバ的には再生開始しているみたいだから、後から入ってきたりリロードすると再生されたりすることもあるし。
  * コメントタブの「発言」ボタンは廃止。(改行キーで発言できるのにわざわざ使っている人いないだろう)<br>空いた場所に「運営コメ欄に表示」チェックボックスを追加。<br>直前にhidden+/permのコメがあった場合、自動で/clsを行います。
  * コメントリフレクターの実装。<br>指定の視聴者のコメントを運営コメントで再コメントします。
  * 動画情報を送信する前に、必要があれば自動で/clsを送るようにした。必要がなければ送りません。<br>リクエスト放送向けを謳っているので動画情報の表示は重要でしょうと、設定の有無なしで、無条件で。
  * P名除外に jp を加えたときに jP も一緒に引っかかっていたのを修正。
  * コメント行の背景色設定追加。

=0.9.10=
  * プレイスタイルメニューの並びを整理
  * リクエスト消費数順再生の実装時に、次枠持ち越しのリク残からリクエスト数の再構築を行っていたが、消化率計算用を元にしていたころの名残で使ってなかったので削除。<br>つまり1枠あたりのリク受け付け数の意味が違ってたなぁ。
  * 再生時、即座に動画情報1行目から送信をするように。<br>/playに連続して動画情報送信しても、再生エラーの場合に再生されず主コメだけ出るのはかっこわるいなぁと思ってウェイトがあったけど、そういえば/playを受け取ってから主コメ仕様だったのを思い出した。(再生エラーのときは主コメされることが絶対にない)
  * 再生エラー動画をリクエストに追加しても再生されないバグ修正。
  * テーブルでマウスカーソルが範囲選択もできないのにtextだったのをdefaultにするようにしたのと、コメントテーブルでカーソル行を明るいグレーに。
  * 放送終了時刻は放送開始から30分後と決めて行動していたが、getpublishstatusからendtimeを取得して、実際の放送終了時刻を元に枠の時間を決めるようにした。<br>延長されたかどうかは分からないので、終了時刻過ぎても放送が継続しているなら新しい終了時刻を取得する。
  * 通知領域での通知を、15秒で自動で閉じるように。
  * 一時停止ボタンをチェックボタンに。<br>チェックされている間は自動で次曲を再生しません。
  * メインウィンドウのタブ状態を記憶するように。
  * 分類エンジンのプロトタイプ実装
  * 再生履歴を記録するタイミングを/playを受け取った時に変更。
  * ステータスバーのツールチップで表示しているリクエスト総時間を、1つの動画の最大再生時間を加味した表示に変更。

=0.9.9=
  * 動画情報の再送信を、次曲再生始めたときにタイマー止めるように。<br>DxM見てたら前曲の動画情報再送信用のタイマーが次曲のときに発動して二重コメになってたので。
  * プリセットオートコンプリートを有効に。<br>ニコリクVA系に見られるジングル動画の選択の類似っぽいのを、コメント入力欄のオートコンプリートを利用してできるように。
  * 動画DBの自動更新は止めますかね。手動でUpdateボタンを押すと更新開始に。<br>再検索が行われると更新は停止します。
  * NGワード処理のON/OFF追加
  * 動画情報のプレビュー搭載<br>レンダリングはGecko任せかつxhtmlで評価されて厳しいので、書き方ミスると全く表示されません。とくにタグの入れ子状態とかおかしいとダメ。
  * ウィンドウ座標、サイズの保存の方法を変更。
  * 左右ペインを分割しているスプリッタの状態を保存。
  * 「サブ画面」チェックボタンの状態を保存。
  * 再生履歴の表示タイプの状態も保存。
  * ウィンドウサイズをデフォルトに戻すをウィンドウデコレーション計算して真のデフォルトサイズに戻るように修正。

=0.9.8=
  * リクエストの応答コメント設定の中に、応答用じゃないコメント設定があったので移動。
  * リクエスト可否切り替えコメントに、コマンド指定を追加。
  * 動画DB内情報の自動更新。<br>検索結果が安定したときに、その結果の中から1週間以上更新のなかったものについて、10秒ごとに10件ずつ更新するようにした。
  * 従来は動画情報の取得が終わった順だったが、リクエストは処理順ではなくコメ順になるように修正。
  * スタートアップコメントを追加。<br>生放送開始して3分以内、何も動画を再生していないときにHelperで接続すると(自動ジングル再生の条件と同じ)、5秒間隔でスタートアップコメントを送信します。<br>送信要求は 5秒間隔で行っても、ラグによっては順番が変わる可能性もあります。<br>ジングル再生とは順序付けしてなく、独立して行われるので注意。<br>スタートアップコメントに/playを入れてしまう手もあり。
  * NGワードが含まれるときに背景色グレーにする処理を入れた。
  * modifiersをcontrolからaccelにしたので、MacだとAppleキー(だっけ?)になる…はず。
  * レート(お気に入り度)を設定、表示するように。<br>0.7.3でデータを載せて以来ようやく。<br>動画DBにない動画への設定は、保存されません。
  * 類似P名除去がおかしかったのを修正。
  * {=_statement_}で数値を自動で小数点数以下1桁までにするのは廃止。
  * 視聴者コマンドを実装。
  * 動画情報を自動で復帰するようにした。

=0.9.7=
  * リクエストもストックと同じ並べ替えメニューを載せた。
  * 放送終了3分前告知を、従来の通知領域、ダイアログ、運営コメントの3種類に増やした。<br>ついでに「放送時間残り3分になりました」に変更。
  * プレイリスト機能の再生で、プレイスタイルの自動or手動見て次曲再生を自動で行うか否かを決めるようにした。
  * P名ホワイトリストタブを、動画情報タブ内に移動。
  * 動画情報の運営コメントにコマンドも入力できるようにした。
  * 再生履歴の表示を従来のテキストに加えて、リクなどの表示と同じものを用意。
  * コマンドメニューにウィンドウサイズを初期状態に戻すを追加。<br>ただし真の初期値にはならず、ウィンドウ全体のサイズのみ(window.resizeToの仕様で)。
  * D名除外リストに～EDが入ってなかったので追加。(DxM生見るまで気づかなかった…)
  * マイリスト追加メニュー作成処理を整理した。
  * 動画情報コメント(運営コメント)で、{=_statement_} を追加。<br>マクロでサポートしていない任意の値を数式で表現してコメントできる。<br>例、ぼからん補正値:{=(info.mylist_counter+info.view_counter)/(info.mylist_counter+info.view_counter+info.comment_num)}<br>聴き入り度:{=info.view_counter/info.comment_num}<br>{=1+1}とやると2.0って出たり。<br>条件分岐なども出来たりして。
  * ↑の機能を載せたおかげで、今まで編集できなかった自動応答コメントを編集できるようにした。

=0.9.6=
  * ステータスバーのリク数、ストック残数のところで、ツールチップにリクエスト総時間の情報を表示するように。
  * 手動再生でも先読みするように変更。ランダムは次を予測できないので今まで通り先読みなし。
  * 主コメがstatus=errorになったときに 1回だけリトライするように変更。
  * リク、ストック、エラータブでタイトルの右隣にP名表示。
  * F5キーでストックの再描画。
  * リク、ストック、エラータブでP名表示するようになってDBへのアクセスが増えるため、キャッシュを設けたので、他のウィンドウで変更したP名がすぐに反映されないことがあります。
  * 誰P,きれいな誰P という類似P名があるときに、後者の方をP名として残して他を削除するようにした。
  * CTRL+M でプログレスバーに表示されている現在再生中の動画をとりあえずマイリストする。
  * ～jpをP名候補から除外。
  * cosMo(暴走P)のために"P)"で終わるものもP名として認識していたけど、曲名(誰P)となっているものを除外できるように (誰P) を含んだものをP名から除外。
  * ストックのプレイリスト機能で、再生ボタンを押したときに常に新規タブを用意していたけど、すでに作ったタブがあればそのタブを利用して再生する。
  * ロスタイム90秒あるものとして扱っていたが、少しばらつきが大きいので75秒に縮小。
  * ストックの操作を速くした。<br>並べ替えとかシャッフルみたいな中身がどっと変わるようなものは変わらず。
  * *-----ここまで 0.9.6pre1-----*
  * ↑↓ボタンで再生済み背景色が移動していなかったのを修正。
  * /prepare(動画の先読み)を行うか行わないかを選択する設定を基本設定の進行のところに追加。
  * リクエスト、ストック内をキーワード検索できるようにした。<br>CTRL+Fで検索開始、F3で次を検索。
  * 任意の動画で/prepareを送信するメニューを追加。

=0.9.5=
  * 再生中動画のプログレスバーでクリックすると、経過時間と残り時間の表示切り替えをする<br>ただし設定として保存していないので、切り替え状態の有効期限はその枠限り。
  * 手動再生の時、最大再生時間が設定されているとそこで再生終了として扱ってプログレスバーの表示がなくなるので、最大再生時間設定は自動再生時のみにして修正。
  * Firefoxのメニューバー「ツール」内に「NicoLive Helper」の項目を追加して、過去にHelperが接続した生放送を最大20件表示。<br>選択するとその生放送にジャンプする。
  * 世界の新着も(公式生も？)自動起動の対象になった。
  * コミュ別ジングル設定を追加。
  * P名ホワイトリストの設定窓口を追加。<br>内部で持っているP名リストと合成して使います。変更後はHelper起動し直しで有効。
  * JSONファイルの情報表示をリク、ストック、エラータブのリストに追加。<br>任意データであることを表せる良い表記が思いつかなかったので、ミクノ度の髭マークを使うことにした。<br>データが存在しないときは何も表示しない。
  * 最大化するとウィンドウのZオーダーがリセットされるので、リサイズ時にウィンドウのZオーダーを再設定するように。<br>最大化時のZオーダー設定はできない(エラーになる)ことが分かったので、最大化状態で最前面表示は不可能。
  * リクエスト消費数順再生を有効に。<br>ただし、ストックからリクエストボタンでリクエストに追加したものは、通常のリクエスト受け付けの窓口を通っていないため、リスナーからのリクエストを完全消化するまで再生されません。
  * マイリストからストック登録するとき、マイリストコメントがあれば動画情報にメモする。<br>{mylistcomment}で表示可能。
  * ストックの再生済み動画を、個別に未再生に戻すメニュー項目追加。
  * 配信開始メニューを追加。ただしExperimental。

=0.9.4=
  * コマンドボタンのフォントサイズを１ポイント下げた。
  * そして一番下に沈める↓↓ボタンを用意。(ボタン増えすぎな感がなくもない)
  * 設定タブをなくして、メニューに移動。
  * ウィンドウ座標の復元のやり方変更。
  * 184コメントを行うか否かの設定を追加。ただし主コメは必ず184コメになるみたい。<br>デフォルトは184コメントON
  * オフラインでのプレイリスト再生するときに動画のflashのあるところまでスクロールさせるように。
  * 動画IDごとに値を設定しているJSONデータを読んでその値と置換する{json}マクロを用意。<br>{additional}はDBに静的に保存される情報で、{json}はインターネットから取得するJSONデータを元にする情報。http:// だけでなく file:// を使ってローカルファイルを読み込ませるのも可。<br>ミクノ度のJSONデータは試し済み。
  * 動画IDを直接コメント入力して再生するとき、動画情報主コメをしないオプションを追加。<br>ジングルの情報も出なくなります。(ジングル再生が動画ID直接入力しての再生と同じことやってるので)
  * 自動で生放送プレイヤーの位置までスクロールする設定追加。
  * コメントログをファイルに書き始めるときの最初の行を、「--- begin log ---」から「--- 番組名 ---」に変更。
  * 連続コメント用テキストファイル保存先を指定して、リストメニューに表示、選択でファイル読み込みをするように。
  * 再生履歴のテキストを復元する機能を付けた。<br>ただし番組名は内部の履歴に残していないので、再生動画リストのみ復元します。

=0.9.3=
  * 動画DBにもストック追加と同じものをD&Dできるように。
  * ウィンドウのx,y,w,hを保存、復元するように。
  * 連続コメントをサポート。<br>テキストボックスにはテキストファイル.txtをD&D可。
  * 再生数0の動画のマイリス率が{mylistrate}のままになるのを修正。
  * P名判定をホワイトリスト優先に変更。
  * Windows Live Messengerのプレゼンスを番組名に設定するように(Win専用の機能)
  * エラーリクエストタブを追加。<br>リクエストを拒否した動画、再生エラーになった動画をリストアップし、必要があればリクエストに追加を行えるように。<br>ストック追加時のものは対象外(「エラー *リクエスト*」タブなので)。
  * ~~コメントの配色変更(パステルカラーのみだと色が似てしまうので)<br>しかし実際に使ってみるとどうも違和感があるな…。反響待ちで。~~ やっぱりパステルカラーじゃないとどうも気に入らないのでナシ。
  * ストック、DBタブへのD&D対象に、ブックマークを追加。
  * ストックもランダム再生の対象に。(今まではストック内はシーケンシャル再生のみだった)<br>しかしミクライブがやっていると確認がっっｗ
  * リクエスト、ストックタブの動画を、コンテキストメニューからマイリス登録できるように。

=0.9.2=
  * &nbsp;とか&amp;とか&lt;の実体参照を変換するように。
  * タイトルに含まれる\u200bの文字を削除するように。
  * 強制生主モードを追加(生主フラグを立てるだけだけど)
  * Helper起動後、枠開始3分以内に何か動画を再生開始すると、「生放送名+放送ID」を再生履歴に記録。(初音ミクのライブのプレイリストに書くときの順ね、実際はPart#しか書かないけど)
  * 世界の新着見てて、説明文の部分も出したいなぁと、{description}を追加。SSDと同じで先頭40文字まで。
  * リクエストのコメ番順ソートを追加。<br>視聴者で見てるときに安価リクでリクが殺到した場面でどこまで採用されるかチェックが面倒だったので(リクエストタブはgetthumbinfo終わった順になるので)。<br>生主でストックからリクエストボタンで移動させたり、テキストボックスから追加したものは後ろ。
  * 動画DBの検索結果のタグに&があると、その動画がリストアップされないので修正
  * オートコンプリートの情報をウィンドウを閉じるタイミングで保存
  * ストックタブに、動画へのアンカー(リンク)、ニコニコ動画の検索ページのタブ、公開マイリストのタブをドロップすると、ストックに中身が追加される。
  * Improve the extra playlist function (what feature was improved is secret.)

=0.9.1=
  * オフライン使用時のストック再生は、最後まで再生すると先頭に戻ってループ再生するように。
  * 生主の座席番号が変わったのに対応。(座席番号使わない判定してもいいか…というか座席番号使わない生主判定って、自動オープンでやってるんだった。いずれこの判定を使わせてもらおう)

=0.9=
  * ツールバーを作成。<br>リクエストタブの、手動、自動再生、リク可否もツールバーに移動。
  * サブ画面など、いくつかの運営コマンドに対応。
  * 自動再生のトリガーを「何か動画を再生した時」のみに。
  * ウィンドウ一覧メニューを付けた。
  * アンケート機能のダイアログ画面など。
  * 入力欄からのストック、DB登録で、複数マイリスに対応。
  * ステータスバーにリク、ストック残数を表示するように。
  * データをストレージに保存するタイミングを、ウィンドウを閉じるときに変更。<br>それ以外ではメモリ上に保存しています。
  * コメントログをファイルに残せるし、クリップボードにコピーもできるので、Open As Textboxはなくした。
  * コメント入力でオートコンプリートを載せた。まだちょっとバグあり。

=0.8=
  * コテハン設定を永続化。ただし184は1週間で破棄。184じゃないものは個別に削除とかはないので一度設定したら永遠に。
  * 今までFirefoxが動いている間のみ保存としていたものを永続化。
  * ジングル再生の動画情報コメ開始のトリガーを変更した(getthumbinfoを行った後に)。おまけで、Helperからの再生を経由せずに主コメから直接動画IDを入力したときも、動画情報コメが出るように。
  * データの永続化に伴って、以前は、生放送と関係ないページでHelperを開いた場合、視聴者として動作してストックのみ保存していたところ、放送者と同等にリクエスト、ストック、再生履歴も復帰、保存するようにした。(データが残るものを主やっているときしか操作できないのは不便なので)
  * 手動、自動再生、リクエスト許可、不可を保存するようにした。保存するタイミングはウィンドウを閉じるとき。
  * ニコ生サーバーとローカルPCの時差補正をするようにした。PCの時刻がニコ生の時刻より進んでいると、生放送開始後、時差の分だけ過去のコメント(無視してもよいコメント)と判断するので。
  * なんかストックをプレイリスト代わりとしてニコニコ動画の動画を連続再生できるようにしてしまった…。ただし、プレミアム会員用のオプションである「動画を自動再生する」にチェックを入れること。再生終わるたびに次の動画のページに移動します。(あくまでオマケ機能なので本腰入れて対応する予定なし)
  * ────────── ここまで 0.8pre1 ──────────
  * ストックでsm/nm番号の含まれる.txtのファイルをドロップすると、それを新しいストックとして取り込むように。
  * 全リクエストをコピーを一番下に移動。
  * 動画DBに登録していない動画でも、P名、追加情報を登録できるように。<br>P名、追加情報専用のテーブルを用意したため、今までに設定されたP名、追加情報は、すべて利用されなくなります。
  * ストックのタイトル順ソート追加。
  * ～P、～Dで終わっていないP名のホワイトリスト適用。…いずれ設定項目に。
  * ストックをファイルに書き出すメニュー項目を追加。
  * voteを使ったときに、質問内容と、結果を主コメする。

=0.7.4=
  * いくつかの警告やエラーは alert() を使っていたのを、通知領域に変更した。alertダイアログはモーダルで割り込みも止まるので、ダイアログ表示中って自動進行とか一切止まってしまうので。
  * リク、ストックタブからは動画のページを開けるのに、動画DBからは開けないのが不便だったので、動画IDにリンクを張るように。
  * ジングル動画が指定されていないときに再生コマンドを送信しないようにした。
  * 日本向けのタグが空の動画があると、リクやストック内の表示系がおかしなことになるのを修正。
  * リクエスト許可、リクエスト不可のボタンを押したときに、自動運営コメント。デフォルト値は設定なし(コメントしない)。

=0.7.3=
  * 再生エラーになった曲はストックに移動。（生拒否にしていなくても、たまに起きるので）<br>最終的にはリクエスト受付拒否とかも含めて、エラー動画として扱うようになるかも。
  * リクエスト制限追加(リクエスト縛りにどうぞ)
  * アンカー指定でのリクエスト受け付け(マニュアルのコメント項目を参照で)
  * リク、ストックの動画詳細内のsm,nm,mylistにリンク付けるように。
  * リク、ストックで、動画にカーソルを持っていくと、チップヘルプでビットレートを表示するように。
  * ツール上から発言される運営コメントは全てマクロ展開の対象に。動画情報以外でも{title}などが展開される。当然、入力欄から入力したコメも対象。
  * {mylistrate}マイリス率を追加
  * {requestnum}, {requesttime}, {stocknum}, {stocktime} を追加。マニュアルの運営コメントのマクロ項目参照で。
  * 動画DBのフィールドにお気に入り度を追加しておいた(あとで使う予定)
  * ジングル再生ボタンをジングル動画設定の横に付けた。ボタンの効果があるのは通常のジングル再生と同じで、放送開始3分以内で、何も動画を再生していないときに、ボタン押して5秒後にジングル再生を始める。

  * この時にGoogle Codeに引っ越ししたので、リポジトリをどうやってインポートすりゃいんだろう…と分からなかったので履歴がもったいないと思いつつリポジトリ破棄。

=0.7=
  * この辺でコテハン設定が追加される。

=0.6=
  * この辺で設定タブを追加したかも。

=0.5=
  * ニコニコ動画(9)に対応しただけ…？(コミュ掲示板を辿ってみると)

=0.4=
  * 動画DBが載ったバージョン。

=0.3=
  * 視聴者で使うときに下コメできるようにしたバージョン。

=0.2=
  * GUIを載せて初めて一般公開したバージョン。<br>この時はまだツールバーやコンテキストメニューもなし。

=0.1=
  * 運営コメントから@playnextなどのコメントを入力することで、進行管理などを行う最初期。全て英語版。<br>一般未公開。